# Анализатор логов

## Описание проекта

Лог-файлы - важная часть работы любого сервера, так как они содержат информацию о запросах, ошибках и выполненных действиях. Однако обработка и анализ этих логов вручную может быть очень трудоемким процессом. 
Данная программа-анализатор логов значительно упрощает этот процесс.

## Возможности программы

Программа позволяет:
- Анализировать один или несколько NGINX лог-файлов, указанных через аргументы командной строки.
- Использовать локальные шаблоны или URL для указания пути к логам.
- Устанавливать необязательные временные параметры `from` и `to` в формате ISO8601.
- Выбирать формат вывода результата: `markdown` или `adoc`.

Программа использует потоковую обработку данных для работы с лог-файлами, а также собирает всю статистику за один проход, что повышает эффективность и уменьшает потребления памяти.

## Функционал

Программа выполняет следующие задачи:
- **Подсчет общего количества запросов**: быстрый анализ загруженности сервера.
- **Определение наиболее часто запрашиваемых ресурсов**: помогает выявить популярные страницы и файлы.
- **Определение наиболее часто встречающихся кодов ответа**: позволяет быстро идентифицировать ошибки и проблемы с доступностью.
- **Определение наиболее частых IP‑адреса источников запросов**: помогает выявлять активных пользователей и аномалии.
- **Расчет среднего размера ответа сервера**: предоставляет данные для оценки производительности.
- **Расчёт 95% и 50% перцентилей размера ответа сервера.**

## Входные и выходные данные

### Ввод

Ввод производится через аргументы командной строки.

- Путь к лог-файлам: локальный путь (с поддержкой glob) или URL.
- Временные параметры: `from` и `to` в формате ISO8601 (опционально).
- Формат вывода: `markdown` или `adoc` (опционально).

#### Примеры ввода:
```
--path logs/2024* --from 2024-08-31 --format markdown
--path https://raw.githubusercontent.com/elastic/examples/master/Common%20Data%20Formats/nginx_logs/nginx_logs --format adoc
--path logs/**/2024-08-31.txt
```
### Вывод

- Текстовый отчёт в выбранном формате с анализом логов.

#### Пример вывода:
```
#### Общая информация

| Метрика               | Значение                                                                                                |
|:---------------------:|:-------------------------------------------------------------------------------------------------------:|
| Файл(-ы)              | https://raw.githubusercontent.com/elastic/examples/master/Common%20Data%20Formats/nginx_logs/nginx_logs |
| Начальная дата        | 2015-05-20                                                                                              |
| Конечная дата         | 2015-06-01                                                                                              |
| Количество запросов   | 34388                                                                                                   |
| Средний размер ответа | 704221b                                                                                                 |
| 50p размера ответа    | 333b                                                                                                    |
| 95p размера ответа    | 1768b                                                                                                   |

#### Запрашиваемые ресурсы

| Ресурс               | Количество |
|:--------------------:|:----------:|
| /downloads/product_1 | 20030      |
| /downloads/product_2 | 14307      |
| /downloads/product_3 | 51         |

#### Коды ответа

| Код | Количество |
|:---:|:----------:|
| 404 | 22429      |
| 304 | 8998       |
| 200 | 2815       |

#### IP‑адреса источников запросов

| IP-адрес       | Количество |
|:--------------:|:----------:|
| 216.46.173.126 | 1515       |
| 65.39.197.164  | 1095       |
| 204.77.168.241 | 1054       |
```

## Тестирование

Тесты проверяют следующие аспекты:
- Проверка чтения файлов по локальному пути (абсолютному или относительному) и через URL.
- Тестирование парсера логов на корректность разбора формата логов.
- Проверка фильтрации по временному диапазону на различных случаях.
- Тесты для подсчета статистики, проверяющие правильность расчетов.
- Валидация формата и содержимого выходного отчета.
